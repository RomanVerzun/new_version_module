# Module Testing Application

Приложение для тестирования и управления модулями через последовательное соединение с графическим интерфейсом на PyQt6.

## Описание

Это приложение предназначено для:
- Подключения к модулям через последовательный порт
- Мониторинга состояния входов модуля
- Управления выходными реле
- Автоматического поиска модулей
- Тестирования функциональности модулей

## Требования

- Python 3.8+
- PyQt6
- pyserial

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd new_version_module
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

1. Запустите приложение:
```bash
python main.py
```

2. Настройте параметры подключения:
   - Выберите COM-порт
   - Установите адрес модуля (1-255)
   - Нажмите "Соединение" для подключения

3. Для автоматического поиска модуля:
   - Нажмите кнопку "Найти"
   - Приложение автоматически переберет адреса от 1 до 255

4. После успешного подключения:
   - Кнопка "Тестирование" становится активной
   - Можно управлять состоянием плат через комбобоксы

## Структура проекта

```
├── main.py              # Основное окно приложения
├── module.py            # Управление модулем и реле
├── board_io.py          # Классы для управления платами ввода/вывода
├── SerialConnection.py  # Класс для работы с последовательным портом
├── dcon.py              # Протокол DCON для связи с модулями
├── relay_manager.py     # Базовые классы для управления реле
├── config.py            # Система конфигурации
├── logger.py            # Настройка логирования
├── util.py              # Вспомогательные функции
├── relays.py            # Константы реле
├── iterator.py          # Итератор для кнопок
└── requirements.txt     # Зависимости проекта
```

## Конфигурация

Приложение создает файл `config.json` для хранения настроек:

```json
{
  "serial": {
    "default_port": "COM4",
    "default_baud_rate": 115200,
    "timeout": 1.0,
    "timer_interval": 100
  },
  "ui": {
    "window_title": "Module Tester",
    "timer_intervals": {
      "test_relays": 300,
      "label_update": 200,
      "find_module": 100
    }
  },
  "module": {
    "default_address": 0,
    "max_address": 255,
    "min_address": 1
  }
}
```

## Разработка

### Линтинг и форматирование

```bash
# Установка инструментов разработки
pip install flake8 black isort

# Проверка кода
flake8 .

# Форматирование кода
black .
isort .
```

### Тестирование

```bash
# Запуск тестов
pytest
```

## Улучшения в коде

### Выполненные улучшения:

1. **Управление конфигурацией**: Добавлена система конфигурации с файлом config.json
2. **Улучшенное логирование**: Переписана система логирования с лучшим форматированием
3. **Обработка ошибок**: Заменены голые except на конкретные исключения
4. **Повторное использование кода**: Созданы базовые классы для устранения дублирования
5. **Валидация данных**: Добавлена валидация входных параметров
6. **Документация**: Добавлены docstrings и комментарии
7. **Инструменты разработки**: Настроены flake8, black, isort

### Архитектурные улучшения:

- Разделение ответственности между классами
- Улучшенная система ошибок с пользовательскими исключениями
- Конфигурируемые параметры вместо магических чисел
- Логика повторных попыток для надежности соединения

## Известные проблемы

- Требуется PyQt6 для запуска GUI
- Некоторые функции тестирования требуют реального железа

## Лицензия

[Укажите лицензию проекта]

## Авторы

[Укажите авторов проекта]